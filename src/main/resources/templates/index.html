<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Insert title here</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>
	<form method="post" id="createProductForm">
		<label>Sku:</label><input name="sku" type="text" /> 
		<label>Name:</label><input name="name" type="text" />
		<label>Description</label><input name="description" type="text" /> 
		<label>Price</label><input name="price" type="text" />
		<button type="submit" name="button">OK</button>
	</form>

	<form action="/image" method="post" enctype="multipart/form-data">
		<label>Image name:</label><input name="name" type="text" /><br /> 
		<label>Image
			file:</label><input name="file" type="file" /><br />
		<button type="submit">Submit</button>
	</form>

	<button id="loadImages">pictures</button>
	<button id="iterateImages">iterate</button>

	<div id="imageList"></div>
	<input id="images"/>

</body>

<script type="text/javascript">

$(function(){
	$('#iterateImages').on('click',function(e) {
		var arr = $('#imageList img').map(function() { return this.src; }).get()
		console.log(arr)
		$('#images').val(JSON.stringify($(arr).serializeObject()))
	})	
	});


$(function() {
	$('#createProductForm').on('submit',function (e) {
		e.preventDefault();
	    $.ajax({
	        url: '/products',
	        cache: false,
	        type: 'POST',
	        contentType: 'application/json',
	        data : JSON.stringify($('#createProductForm').serializeObject()),
	        success: function(json) {
	            alert('');
	        }
	    });
	});
});

$(function(){
	$('#loadImages').on('click',function(e) {
	e.preventDefault();
	$.ajax({
		url:'/image/all',
		type: 'get',
		success: function(json) {
			var data = json;
			console.log(data);
			$.each(data, function(i,item){
				$('#imageList').append('<div>'+'<img src="upload-dir/'+item.imageName+'.jpg" name="imageName"/></div>');
			})
		}
	})})
});



$.fn.serializeObject = function()
{
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
};
</script>
</html>